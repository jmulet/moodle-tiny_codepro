define("tiny_codepro/htmlfy-lazy",["exports"],(function(_exports){Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.default=void 0;const CONFIG={ignore:[],ignore_with:"_!i-£___£%_",strict:!1,tab_size:2,tag_wrap:!1,tag_wrap_width:80,trim:[]},isHtml=content=>/<(?<Element>[A-Za-z]+\b)[^>]*(?:.|\n)*?<\/{1}\k<Element>>/.test(content),mergeObjects=(current,updates)=>{if(!current||!updates)throw new Error("Both 'current' and 'updates' must be passed-in to mergeObjects()");let merged;if(Array.isArray(current))merged=structuredClone(current).concat(updates);else if("object"==typeof current){merged={...current};for(let key of Object.keys(updates))"object"!=typeof updates[key]?merged[key]=updates[key]:merged[key]=mergeObjects(merged[key]||{},updates[key])}return merged},validateConfig=config=>{var _config$ignore,_config$trim;if("object"!=typeof config)throw new Error("Config must be an object.");if(!(Object.hasOwn(config,"ignore")||Object.hasOwn(config,"ignore_with")||Object.hasOwn(config,"strict")||Object.hasOwn(config,"tab_size")||Object.hasOwn(config,"tag_wrap")||Object.hasOwn(config,"tag_wrap_width")||Object.hasOwn(config,"trim")))return CONFIG;let tab_size=config.tab_size;if(tab_size){if("number"!=typeof tab_size)throw new Error(`tab_size must be a number, not ${typeof config.tab_size}.`);if(!Number.isSafeInteger(tab_size))throw new Error(`Tab size ${tab_size} is not safe. See https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/isSafeInteger for more info.`);if(tab_size=Math.floor(tab_size),tab_size<1||tab_size>16)throw new Error("Tab size out of range. Expecting 1 to 16.");config.tab_size=tab_size}if(Object.hasOwn(config,"ignore")&&(!Array.isArray(config.ignore)||null===(_config$ignore=config.ignore)||void 0===_config$ignore||!_config$ignore.every((e=>"string"==typeof e))))throw new Error("Ignore config must be an array of strings.");if(Object.hasOwn(config,"ignore_with")&&"string"!=typeof config.ignore_with)throw new Error(`Ignore_with config must be a string, not ${typeof config.ignore_with}.`);if(Object.hasOwn(config,"strict")&&"boolean"!=typeof config.strict)throw new Error(`Strict config must be a boolean, not ${typeof config.strict}.`);if(Object.hasOwn(config,"tag_wrap")&&"boolean"!=typeof config.tag_wrap)throw new Error(`tag_wrap config must be a boolean, not ${typeof config.tag_wrap}.`);if(Object.hasOwn(config,"tag_wrap_width")&&"number"!=typeof config.tag_wrap_width)throw new Error(`tag_wrap_width config must be a number, not ${typeof config.tag_wrap_width}.`);if(Object.hasOwn(config,"trim")&&(!Array.isArray(config.trim)||null===(_config$trim=config.trim)||void 0===_config$trim||!_config$trim.every((e=>"string"==typeof e))))throw new Error("Trim config must be an array of strings.");return((dconfig,config)=>mergeObjects(structuredClone(dconfig),config))(CONFIG,config)},void_elements=["area","base","br","col","embed","hr","img","input","link","meta","param","source","track","wbr"],entify=function(html){let minify=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return html=html.replace(/<textarea[^>]*>((.|\n)*?)<\/textarea>/g,((match,capture)=>match.replace(capture,(match=>match.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/\n/g,"&#10;").replace(/\r/g,"&#13;").replace(/\s/g,"&nbsp;"))))),minify&&(html=html.replace(/<textarea[^>]*>((.|\n)*?)<\/textarea>/g,((match,capture)=>match=(match=match.replace(capture,(match=>match.replace(/\n|\t/g,"").replace(/[a-z]+="\s*"/gi,"").replace(/>\s+</g,"><").replace(/\s+/g," ")))).replace(/\s+/g," ").replace(/\s>/g,">").replace(/>\s/g,">").replace(/\s</g,"<").replace(/class=["']\s/g,(match=>match.replace(/\s/g,""))).replace(/(class=.*)\s(["'])/g,"$1$2")))),html};let strict,trim;const convert={line:[]},preprocess=html=>(html=function(html){return arguments.length>1&&void 0!==arguments[1]&&!arguments[1]||isHtml(html)?html.replace(/<([a-zA-Z\-0-9]+)[^>]*>/g,((match,name)=>void_elements.indexOf(name)>-1?`${match.substring(0,match.length-1)} />`.replace(/\/\s\//g,"/"):match.replace(/[\s]?\/>/g,`></${name}>`))):html}(html,!1),trim.length>0&&(html=((html,trim)=>{for(let e=0;e<trim.length;e++){const leading_whitespace=new RegExp(`(<${trim[e]}[^>]*>)\\s+`,"g"),trailing_whitespace=new RegExp(`\\s+(</${trim[e]}>)`,"g");html=html.replace(leading_whitespace,"$1").replace(trailing_whitespace,"$1")}return html})(html,trim)),html=function(html){return arguments.length>1&&void 0!==arguments[1]&&!arguments[1]||isHtml(html)?(html=entify(html)).replace(/\n|\t/g,"").replace(/[a-z]+="\s*"/gi,"").replace(/>\s+</g,"><").replace(/\s+/g," ").replace(/\s>/g,">").replace(/<\s\//g,"</").replace(/>\s/g,">").replace(/\s</g,"<").replace(/class=["']\s/g,(match=>match.replace(/\s/g,""))).replace(/(class=.*)\s(["'])/g,"$1$2"):html}(html,!1),html=(html=>{convert.line=[];let i=-1;return html.replace(/<[^>]*>/g,(match=>(convert.line.push(match),i++,`\n[#-# : ${i} : ${match} : #-#]\n`)))})(html));return _exports.default=(html,config)=>{if(!isHtml(html))return html;const validated_config=config?validateConfig(config):CONFIG;strict=validated_config.strict;const ignore=validated_config.ignore.length>0;return trim=validated_config.trim,ignore&&(html=((html,config)=>{const ignore=config.ignore,ignore_string=config.ignore_with;for(let e=0;e<ignore.length;e++){const regex=new RegExp(`<${ignore[e]}[^>]*>((.|\n)*?)</${ignore[e]}>`,"g");html=html.replace(regex,((match,capture)=>match.replace(capture,(match=>match.replace(/</g,"-"+ignore_string+"lt-").replace(/>/g,"-"+ignore_string+"gt-").replace(/\n/g,"-"+ignore_string+"nl-").replace(/\r/g,"-"+ignore_string+"cr-").replace(/\s/g,"-"+ignore_string+"ws-")))))}return html})(html,validated_config)),html=((html,config)=>{const step=config.tab_size,wrap=config.tag_wrap,wrap_width=config.tag_wrap_width;let indents="";convert.line.forEach(((source,index)=>{html=html.replace(/\n+/g,"\n").replace(`[#-# : ${index} : ${source} : #-#]`,(match=>{let subtrahend=0;const prevLine=`[#-# : ${index-1} : ${convert.line[index-1]} : #-#]`;indents+="0",0===index&&subtrahend++,match.indexOf(`#-# : ${index} : </`)>-1&&subtrahend++,prevLine.indexOf("<!doctype")>-1&&subtrahend++,prevLine.indexOf("\x3c!--")>-1&&subtrahend++,prevLine.indexOf("/> : #-#")>-1&&subtrahend++,prevLine.indexOf(`#-# : ${index-1} : </`)>-1&&subtrahend++;const offset=indents.length-subtrahend;if(indents=indents.substring(0,offset),strict&&match.indexOf("\x3c!--")>-1)return"";const result=match.replace(`[#-# : ${index} : `,"").replace(" : #-#]","");if(wrap&&/<[A-Za-z]+\b[^>]*(?:.|\n)*?\/?>/g.test(source)&&source.length>wrap_width){const attribute_regex=/\s{1}[A-Za-z-]+(?:=".*?")?/g,tag_parts=source.split(attribute_regex).filter(Boolean),attributes=source.matchAll(attribute_regex),padding=step*offset,inner_padding=padding+step;let wrapped=tag_parts[0].padStart(tag_parts[0].length+padding)+"\n";for(const a of attributes)wrapped+=a[0].trim().padStart(a[0].trim().length+inner_padding)+"\n";return wrapped+=tag_parts[1].padStart(tag_parts[1].trim().length+padding+(strict?1:0)),wrapped}return result.padStart(result.length+step*offset)}))})),html=html.replace(/>[^<]*?[^><\/\s][^<]*?<\/|>\s+[^><\s]|<script[^>]*>\s+<\/script>|<(\w+)>\s+<\/(\w+)|<([\w\-]+)[^>]*[^\/]>\s+<\/([\w\-]+)>/g,(match=>match.replace(/\n|\t|\s{2,}/g,""))),strict&&(html=html.replace(/\s\/>|\/>/g,">"));const lead_newline_check=html.substring(0,1),tail_newline_check=html.substring(html.length-1);return"\n"===lead_newline_check&&(html=html.substring(1,html.length)),"\n"===tail_newline_check&&(html=html.substring(0,html.length-1)),html})(html=preprocess(html),validated_config),ignore&&(html=((html,config)=>{const ignore=config.ignore,ignore_string=config.ignore_with;for(let e=0;e<ignore.length;e++){const regex=new RegExp(`<${ignore[e]}[^>]*>((.|\n)*?)</${ignore[e]}>`,"g");html=html.replace(regex,((match,capture)=>match.replace(capture,(match=>match.replace(new RegExp("-"+ignore_string+"lt-","g"),"<").replace(new RegExp("-"+ignore_string+"gt-","g"),">").replace(new RegExp("-"+ignore_string+"nl-","g"),"\n").replace(new RegExp("-"+ignore_string+"cr-","g"),"\r").replace(new RegExp("-"+ignore_string+"ws-","g")," ")))))}return html})(html,validated_config)),html},_exports.default}));

//# sourceMappingURL=htmlfy-lazy.min.js.map