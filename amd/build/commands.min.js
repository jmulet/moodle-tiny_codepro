define("tiny_codepro/commands",["exports","editor_tiny/utils","core/str","./viewdialog","./common","./options","./viewpanel","./preferences"],(function(_exports,_utils,_str,_viewdialog,_common,_options,_viewpanel,_preferences){Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.getSetup=void 0;_exports.getSetup=async()=>{const[strs,buttonImage]=await Promise.all([(0,_str.get_strings)([{key:"pluginname",component:_common.component},{key:"opendialog",component:_common.component},{key:"fullscreen",component:_common.component},{key:"themes",component:_common.component},{key:"linewrap",component:_common.component},{key:"prettify",component:_common.component},{key:"decreasefontsize",component:_common.component},{key:"increasefontsize",component:_common.component}]),(0,_utils.getButtonImage)("icon",_common.component)]),[pluginName,...translations]=strs;return async editor=>{if(!(0,_options.isPluginVisible)(editor))return void editor.ui.registry.addMenuItem(_common.component,{icon:"sourcecode",text:"Source code",onAction:()=>editor.execCommand("mceCodeEditor",!1)});editor.on("PreInit",(()=>{var _editor$parser;const schema=null===(_editor$parser=editor.parser)||void 0===_editor$parser?void 0:_editor$parser.schema;if(!schema)return;const customElements=((0,_options.getCustomElements)(editor)??"").trim();customElements&&schema.addCustomElements(customElements);const validElements=((0,_options.getValidElements)(editor)??"").trim();validElements&&schema.addValidElements(validElements);const validChildren=((0,_options.getValidChildren)(editor)??"").trim();validChildren&&schema.addValidChildren(validChildren)})),editor.ui.registry.addIcon(_common.icon,buttonImage.html);const _viewManagers={},getViewManager=name=>{let instance=_viewManagers[name];return instance||(instance="panel"===name?new _viewpanel.ViewPanelManager(editor,{autosave:!0,translations:translations}):new _viewdialog.ViewDialogManager(editor),_viewManagers[name]=instance,instance)};editor.addCommand("mceCodeProEditor",(()=>{let uiMode=(0,_options.getDefaultUI)(editor)??"dialog";uiMode.startsWith("user:")&&(uiMode=(0,_preferences.getPref)("view",uiMode.substring(5))),(0,_preferences.setPref)("view",uiMode),getViewManager(uiMode).show()})),editor.ui.registry.addButton(_common.component,{icon:_common.icon,tooltip:pluginName,onAction:()=>editor.execCommand("mceCodeProEditor",!1)}),editor.ui.registry.addMenuItem(_common.component,{icon:_common.icon,text:pluginName,onAction:()=>editor.execCommand("mceCodeProEditor",!1)});const defaultUI=(0,_options.getDefaultUI)(editor)??"";("panel"===defaultUI||defaultUI.startsWith("user:"))&&getViewManager("panel")._tCreate()}}}));

//# sourceMappingURL=commands.min.js.map